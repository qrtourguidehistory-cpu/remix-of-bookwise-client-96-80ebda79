import{v as G,j as e,C as M,B as l,S as Q,u as J,b as K,a as V,r as k,N as S,Q as _,c as f}from"./index-YNrFhYI6.js";import{I as X}from"./ImageCarousel-DuB7UC5p.js";import{a as Y}from"./useEstablishments-CfIEf30O.js";import{u as Z,H as ee}from"./useFavorites-C97UnMRx.js";import{u as se,g as te}from"./useBusinessHours-D_W3eGfM.js";import{S as m}from"./skeleton-Jpt_-XlJ.js";import{A as D}from"./arrow-left-C99VgAQq.js";import{S as re}from"./star-DX0NmqmN.js";import{M as C}from"./map-pin-BDvPjSKo.js";import{P as ne}from"./phone-C6FhwCni.js";import{E as P}from"./external-link-bqxPAhuG.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=G("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);function ie({service:a,onSelect:d,selected:t}){a.currency;const x=a.price_rd!==void 0&&a.price_rd!==null?Number(a.price_rd):a.price?Number(a.price):0,u=a.price_usd!==void 0&&a.price_usd!==null?Number(a.price_usd):0;return e.jsxs("div",{className:"flex items-center justify-between p-4 bg-card rounded-xl border border-border hover:border-primary/30 transition-colors",children:[e.jsxs("div",{className:"flex-1 min-w-0 mr-4",children:[e.jsx("h4",{className:"font-medium text-foreground",children:a.name}),a.description&&e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-1 mt-0.5",children:a.description}),e.jsxs("div",{className:"flex items-center gap-2 mt-2 text-sm text-muted-foreground",children:[e.jsx(M,{className:"w-3.5 h-3.5 text-gray-600",strokeWidth:2}),e.jsxs("span",{children:[a.duration," min"]})]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-2",children:[e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-semibold text-foreground",children:["RD$ ",x.toLocaleString()]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["USD $",u.toFixed(2)]})]}),e.jsx(l,{variant:t?"coral":"coral-outline",size:"sm",onClick:()=>d(a),children:t?"Seleccionado":"Seleccionar"})]})]})}const je=()=>{const{id:a}=Q(),d=J(),{t}=K(),{user:x,isGuest:u}=V(),{isFavorite:z,toggleFavorite:B}=Z(),{establishment:r,services:h,paymentMethods:j,loading:F,error:R}=Y(a),{hours:b}=se(a),[i,$]=k.useState([]),N=k.useMemo(()=>{const s=new Date,n=b||te(a),o=p=>{const[g,O]=p.split(":").map(Number);return g*60+O},c=s.getHours()*60+s.getMinutes(),A=o(n.openTime),q=o(n.closeTime);if(n.lunchStart&&n.lunchEnd){const p=o(n.lunchStart),g=o(n.lunchEnd);if(c>=p&&c<g)return!1}return c>=A&&c<q},[b,a]),E=s=>{$(n=>n.find(c=>c.id===s.id)?n.filter(c=>c.id!==s.id):[...n,s])},T=async()=>{if(u||!x){_({title:t("common.loginRequired"),description:t("favorites.loginToSave"),variant:"destructive"});return}a&&await B(a)},H=i.reduce((s,n)=>s+(n.price_rd||n.price||0),0),y=i.reduce((s,n)=>s+(n.price_usd||0),0),W=i.reduce((s,n)=>s+n.duration,0),I=()=>{const s=(r==null?void 0:r.phone)||"";s&&(window.location.href=`tel:${s.replace(/\s/g,"")}`)},L=()=>{const s=(r==null?void 0:r.address)||"";if(s){const n=encodeURIComponent(s);window.open(`https://www.google.com/maps/search/?api=1&query=${n}`,"_blank")}};if(F)return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsxs("div",{className:"relative h-56 bg-gradient-to-br from-secondary to-muted",children:[e.jsx(m,{className:"w-full h-full"}),e.jsx("div",{className:"absolute top-0 left-0 right-0 p-4 flex items-center justify-between z-10",children:e.jsx(l,{variant:"secondary",size:"icon",className:"rounded-full",onClick:()=>d(-1),children:e.jsx(D,{className:"w-5 h-5"})})})]}),e.jsx("div",{className:"max-w-lg mx-auto px-4 -mt-8 relative z-10",children:e.jsxs("div",{className:"bg-card rounded-2xl shadow-card p-5",children:[e.jsx(m,{className:"h-6 w-48 mb-2"}),e.jsx(m,{className:"h-4 w-32 mb-3"}),e.jsx(m,{className:"h-20 w-full"})]})})]});if(R||!r)return e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center px-4",children:[e.jsx("h2",{className:"text-xl font-bold text-foreground mb-2",children:t("common.error")}),e.jsx("p",{className:"text-muted-foreground mb-4",children:t("business.notFound")}),e.jsx(l,{variant:"coral",onClick:()=>d("/"),children:t("common.goBack")})]})});console.log("BusinessProfile - dbServices received:",h.length,h.map(s=>({id:s.id,name:s.name})));const v=h.map(s=>{const n=s.price_rd!==void 0?Number(s.price_rd):Number(s.price||0),o=s.price_usd!==void 0?Number(s.price_usd):0;return{id:s.id,name:s.name,description:s.description||"",duration:s.duration_minutes||30,price:Number(s.price||0),price_rd:n,price_usd:o,price_currency:s.price_currency||"DOP",currency:s.price_currency||"DOP"}}),w=r.main_image?[r.main_image]:[],U=a?z(a):!1;return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsxs("div",{className:"relative h-56 bg-gradient-to-br from-secondary to-muted",children:[w.length>0?e.jsx(X,{images:w,alt:r.name}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-muted",children:e.jsx("span",{className:"text-muted-foreground",children:t("business.noImage")})}),e.jsxs("div",{className:"absolute top-0 left-0 right-0 p-4 flex items-center justify-between z-10",children:[e.jsx(S,{to:"/",children:e.jsx(l,{variant:"secondary",size:"icon",className:"rounded-full shadow-card",children:e.jsx(D,{className:"w-5 h-5"})})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(l,{variant:"secondary",size:"icon",className:"rounded-full shadow-card",onClick:()=>{const s=window.location.href,n=`Check out ${r.name}!`;navigator.share?navigator.share({title:r.name,text:n,url:s}):(navigator.clipboard.writeText(s),_({title:t("common.linkCopied")}))},children:e.jsx(ae,{className:"w-5 h-5"})}),e.jsx(l,{variant:"secondary",size:"icon",className:"rounded-full shadow-card",onClick:T,children:e.jsx(ee,{className:f("w-5 h-5 transition-colors",U&&"fill-primary text-primary")})})]})]})]}),e.jsxs("div",{className:f("max-w-lg mx-auto px-4 -mt-8 relative z-10",i.length>0?"pb-36":"pb-8"),children:[e.jsxs("div",{className:"bg-card rounded-2xl shadow-card p-5 animate-slide-up",children:[e.jsx("h1",{className:"text-xl font-bold text-foreground mb-2",children:r.name}),e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(re,{className:"w-4 h-4 text-warning fill-warning"}),e.jsx("span",{className:"font-semibold text-foreground",children:r.rating||0}),e.jsxs("span",{className:"text-muted-foreground text-sm",children:["(",r.review_count||0," ",t("business.reviews"),")"]})]}),r.address&&e.jsxs("span",{className:"flex items-center gap-1 text-muted-foreground text-sm",children:[e.jsx(C,{className:"w-4 h-4 text-gray-700",strokeWidth:2}),r.address]})]}),r.description&&e.jsx("p",{className:"text-muted-foreground text-sm mb-4",children:r.description}),e.jsx("div",{className:"flex items-center gap-4 text-sm",children:e.jsxs("span",{className:f("flex items-center gap-1.5",N?"text-success":"text-destructive"),children:[e.jsx(M,{className:"w-4 h-4 text-gray-700",strokeWidth:2}),t(N?"business.openNow":"business.closedNow")]})})]}),e.jsxs("section",{className:"mt-6 animate-slide-up",style:{animationDelay:"0.1s"},children:[e.jsx("h2",{className:"text-lg font-bold text-foreground mb-4",children:t("business.services")}),v.length>0?e.jsx("div",{className:"space-y-3",children:v.map(s=>e.jsx(ie,{service:s,onSelect:E,selected:i.some(n=>n.id===s.id)},s.id))}):e.jsx("div",{className:"bg-card rounded-xl border border-border p-4 text-center",children:e.jsx("p",{className:"text-muted-foreground",children:t("business.noServices")})})]}),(r.phone||r.address)&&e.jsxs("section",{className:"mt-6 animate-slide-up",style:{animationDelay:"0.15s"},children:[e.jsx("h2",{className:"text-lg font-bold text-foreground mb-4",children:t("business.contact")}),e.jsxs("div",{className:"bg-card rounded-xl border border-border p-4 space-y-3",children:[r.phone&&e.jsxs("button",{onClick:I,className:"w-full flex items-center gap-3 hover:bg-secondary/50 -mx-2 px-2 py-2 rounded-lg transition-colors",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gray-100 flex items-center justify-center",children:e.jsx(ne,{className:"w-5 h-5 text-gray-700",strokeWidth:2})}),e.jsxs("div",{className:"text-left flex-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:t("business.phone")}),e.jsx("p",{className:"font-medium text-foreground",children:r.phone})]}),e.jsx(P,{className:"w-4 h-4 text-gray-500",strokeWidth:2})]}),r.address&&e.jsxs("button",{onClick:L,className:"w-full flex items-center gap-3 hover:bg-secondary/50 -mx-2 px-2 py-2 rounded-lg transition-colors",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gray-100 flex items-center justify-center",children:e.jsx(C,{className:"w-5 h-5 text-gray-700",strokeWidth:2})}),e.jsxs("div",{className:"text-left flex-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:t("business.address")}),e.jsx("p",{className:"font-medium text-foreground",children:r.address})]}),e.jsx(P,{className:"w-4 h-4 text-gray-500",strokeWidth:2})]})]})]}),e.jsxs("section",{className:"mt-6 animate-slide-up",style:{animationDelay:"0.2s"},children:[e.jsx("h2",{className:"text-lg font-bold text-foreground mb-4",children:t("business.paymentMethods")}),e.jsxs("div",{className:"bg-card rounded-xl border border-border p-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:t("business.paymentMethodsDesc")}),e.jsx("div",{className:"flex flex-wrap gap-2",children:j.length>0?j.map(s=>e.jsx("span",{className:"px-3 py-1 bg-secondary text-secondary-foreground text-xs rounded-full",children:s.name},s.id)):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"px-3 py-1 bg-secondary text-secondary-foreground text-xs rounded-full",children:t("business.cash")}),e.jsx("span",{className:"px-3 py-1 bg-secondary text-secondary-foreground text-xs rounded-full",children:t("business.creditCard")})]})})]})]}),e.jsxs("section",{className:"mt-6 animate-slide-up",style:{animationDelay:"0.25s"},children:[e.jsx("h2",{className:"text-lg font-bold text-foreground mb-4",children:t("business.cancellationPolicy")}),e.jsxs("div",{className:"bg-warning/10 rounded-xl border border-warning/20 p-4",children:[e.jsxs("p",{className:"text-sm text-foreground",children:[t("business.cancellationPolicyText")," ",e.jsx("strong",{children:t("business.cancellationHours")}),"."]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:t("business.cancellationNote")})]})]})]}),i.length>0&&e.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-card border-t border-border p-4 shadow-elevated z-50 animate-slide-up",children:e.jsxs("div",{className:"max-w-lg mx-auto",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:[i.length," ",t("business.services_count")," â€¢ ",W," ",t("business.min")]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-lg font-bold text-foreground",children:["RD$ ",H.toLocaleString()]}),y>0&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["USD $",y.toFixed(2)]})]})]})}),e.jsx(S,{to:`/booking/${a}`,state:{services:i},children:e.jsx(l,{variant:"coral",size:"xl",className:"w-full",children:t("business.continueBooking")})})]})})]})};export{je as default};
