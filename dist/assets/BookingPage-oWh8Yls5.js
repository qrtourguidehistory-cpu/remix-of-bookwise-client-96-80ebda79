import{a3 as We,a4 as Ge,r as i,b as xe,j as e,c as Ae,a5 as Be,a6 as Ke,a2 as Qe,d as Xe,u as Ze,s as R,B as V,L as et,C as ie,J as $}from"./index-uyy-nLXi.js";import{I as ce}from"./input-BmlGBm57.js";import{L as le}from"./label-b-StimOP.js";import{C as tt}from"./chevron-left-ByU9rXxB.js";import{C as st}from"./chevron-right-D_GJDYNE.js";import{s as Ie,f as A}from"./format-DUpMykV-.js";import{f as nt}from"./fr-DkOlpS32.js";import{u as rt}from"./useTimeFormat-CZqPQ6EW.js";import{U as me}from"./user-BJBy3O-U.js";import{C as ue}from"./check-CB0uD3YZ.js";import{S as Z}from"./skeleton-D3ME_RUZ.js";import{u as at}from"./useAppointments-l4zjd1dy.js";import{u as ot}from"./useEstablishments-aizZswkc.js";import{u as it,g as ct}from"./useBusinessHours-Ckx48jLO.js";import{u as lt}from"./useDebounce-CFXqmIlz.js";import{A as Te}from"./arrow-left-fKqpYMZU.js";import{C as dt}from"./calendar-rMDyL2cc.js";function de(a,l){const o=We(a);return isNaN(l)?Ge(a,NaN):(l&&o.setDate(o.getDate()+l),o)}function Pe(a,l){const o=Ie(a),n=Ie(l);return+o==+n}function mt({selected:a,onSelect:l}){const[o,n]=i.useState(new Date),{i18n:t}=xe(),S=Array.from({length:7},(c,x)=>de(o,x)),g=(()=>{switch(t.language){case"en":return Ke;case"fr":return nt;default:return Be}})(),j=()=>n(de(o,-7)),h=()=>n(de(o,7));return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{onClick:j,className:"p-2 rounded-lg hover:bg-secondary transition-colors",children:e.jsx(tt,{className:"w-5 h-5 text-muted-foreground"})}),e.jsx("span",{className:"font-medium text-foreground capitalize",children:A(o,"MMMM yyyy",{locale:g})}),e.jsx("button",{onClick:h,className:"p-2 rounded-lg hover:bg-secondary transition-colors",children:e.jsx(st,{className:"w-5 h-5 text-muted-foreground"})})]}),e.jsx("div",{className:"grid grid-cols-7 gap-2",children:S.map(c=>{const x=a&&Pe(c,a),M=Pe(c,new Date);return e.jsxs("button",{onClick:()=>l(c),className:Ae("flex flex-col items-center py-3 rounded-xl transition-all duration-200",x?"bg-primary text-primary-foreground shadow-card":M?"bg-coral-light text-coral":"bg-secondary text-secondary-foreground hover:bg-secondary/80"),children:[e.jsx("span",{className:"text-xs font-medium uppercase",children:A(c,"EEE",{locale:g})}),e.jsx("span",{className:"text-lg font-bold mt-1",children:A(c,"d")})]},c.toISOString())})})]})}function ut({slots:a,selected:l,onSelect:o}){const{formatTime:n}=rt();return e.jsx("div",{className:"grid grid-cols-4 gap-2",children:a.map(t=>e.jsx("button",{onClick:()=>t.available&&o(t.id),disabled:!t.available,className:Ae("py-3 px-2 rounded-lg text-sm font-medium transition-all duration-200",t.available?l===t.id?"bg-primary text-primary-foreground shadow-card":"bg-secondary text-secondary-foreground hover:bg-secondary/80":"bg-muted text-muted-foreground/50 cursor-not-allowed line-through"),children:n(t.time)},t.id))})}function ft({services:a,staffMembers:l,onAssignmentsChange:o}){const{t:n}=xe(),[t,S]=i.useState([]);i.useEffect(()=>{const g=a.map(j=>({serviceId:j.id,serviceName:j.name,staffId:null}));S(g)},[a]);const B=(g,j)=>{const h=t.map(c=>c.serviceId===g?{...c,staffId:j}:c);S(h),o(h)};return a.length<=1?e.jsx("div",{className:"grid grid-cols-1 gap-3",children:l.map(g=>{var j,h;return e.jsxs("button",{onClick:()=>{var c;return B(((c=a[0])==null?void 0:c.id)||"",g.id)},className:`flex items-center gap-3 p-4 rounded-xl border transition-all duration-200 ${((j=t[0])==null?void 0:j.staffId)===g.id?"border-primary bg-primary/10":"border-border bg-card hover:border-primary/30"}`,children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-secondary flex items-center justify-center",children:e.jsx(me,{className:"w-6 h-6 text-muted-foreground"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"font-medium text-foreground",children:g.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:g.specialty})]}),((h=t[0])==null?void 0:h.staffId)===g.id&&e.jsx(ue,{className:"w-5 h-5 text-primary ml-auto"})]},g.id)})}):e.jsx("div",{className:"space-y-6",children:a.map((g,j)=>{const h=t.find(x=>x.serviceId===g.id),c=l.find(x=>x.id===(h==null?void 0:h.staffId));return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-medium text-foreground",children:g.name}),c&&e.jsx("span",{className:"text-sm text-primary font-medium",children:c.name})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:l.map(x=>e.jsxs("button",{onClick:()=>B(g.id,x.id),className:`flex items-center gap-3 p-3 rounded-lg border transition-all duration-200 ${(h==null?void 0:h.staffId)===x.id?"border-primary bg-primary/10":"border-border bg-card hover:border-primary/30"}`,children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-secondary flex items-center justify-center flex-shrink-0",children:e.jsx(me,{className:"w-5 h-5 text-muted-foreground"})}),e.jsxs("div",{className:"text-left min-w-0",children:[e.jsx("p",{className:"font-medium text-foreground text-sm truncate",children:x.name}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:x.specialty})]}),(h==null?void 0:h.staffId)===x.id&&e.jsx(ue,{className:"w-4 h-4 text-primary ml-auto flex-shrink-0"})]},`${g.id}-${x.id}`))}),j<a.length-1&&e.jsx("div",{className:"border-b border-border pt-2"})]},g.id)})})}const I=a=>{const l=(a==null?void 0:a.length)>=5?a.substring(0,5):a,[o,n]=l.split(":").map(Number);return o*60+n},xt=a=>{const l=Math.floor(a/60),o=a%60;return`${l.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}`},Y=(a,l,o)=>Math.max(l,Math.min(o,a)),fe=(a,l,o,n)=>a<n&&l>o;function $e(a){const l=[...a].sort((n,t)=>n.startMin-t.startMin),o=[];for(const n of l){if(o.length===0){o.push({...n});continue}const t=o[o.length-1];n.startMin<=t.endMin?t.endMin=Math.max(t.endMin,n.endMin):o.push({...n})}return o}function gt(a){const{openMin:l,closeMin:o,durationMin:n,breakStartMin:t,breakEndMin:S,busy:B,stepByDuration:g=!0,fallbackStepMin:j,minStartMin:h=0}=a;if(n<=0)return[];const c=o-n;if(c<l)return[];const x=Math.max(l,h),M=$e(B.map(m=>({startMin:Y(m.startMin,x,o),endMin:Y(m.endMin,x,o)})).filter(m=>m.endMin>m.startMin)),L=new Set;L.add(x);for(const m of M)L.add(m.endMin);t!=null&&S!=null&&L.add(S);const u=[...L].sort((m,f)=>m-f),J=new Set,P=(m,f)=>t==null||S==null?!1:fe(m,f,t,S),W=(m,f)=>{let E=null;for(const D of M)fe(m,f,D.startMin,D.endMin)&&(E=E==null?D.endMin:Math.max(E,D.endMin));return E};for(const m of u){let f=Y(m,x,c);for(;f<=c;){const E=f+n;if(P(f,E)&&S!=null){f=Y(S,x,c+1);continue}const D=W(f,E);if(D!=null){f=Y(D,x,c+1);continue}J.add(f),g?f=f+n:j&&j>0?f=f+j:f=f+n}}return[...J].sort((m,f)=>m-f)}const Bt=()=>{var De,we;const{id:a}=Qe(),l=Xe(),o=Ze(),{t:n}=xe(),{establishment:t,staff:S,loading:B,error:g,refetch:j}=ot(a),h=(t==null?void 0:t.name)||"",c=i.useMemo(()=>{if(!t||!t.temporarily_closed)return!1;if(!t.closed_until)return t.temporarily_closed;const s=new Date(t.closed_until),r=new Date;return t.temporarily_closed===!0&&s>r},[t]);i.useEffect(()=>{if(!(t!=null&&t.temporarily_closed)||!(t!=null&&t.closed_until))return;const s=new Date(t.closed_until),r=new Date;if(s<=r)return;const y=s.getTime()-r.getTime(),d=setTimeout(()=>{j()},y+1e3);return()=>clearTimeout(d)},[t==null?void 0:t.closed_until,t==null?void 0:t.temporarily_closed,j]),i.useEffect(()=>{if(!(t!=null&&t.temporarily_closed)||!(t!=null&&t.closed_until))return;const s=setInterval(()=>{new Date(t.closed_until)<=new Date&&j()},3e4);return()=>clearInterval(s)},[t==null?void 0:t.closed_until,t==null?void 0:t.temporarily_closed,j]);const x=i.useMemo(()=>{if(!c||!(t!=null&&t.closed_until))return null;try{const s=new Date(t.closed_until);return A(s,"HH:mm")}catch{return null}},[c,t==null?void 0:t.closed_until]),M=((De=l.state)==null?void 0:De.services)||[],{createAppointment:L}=at(),[u,J]=i.useState(null),[P,W]=i.useState(null),[m,f]=i.useState([]),[E,D]=i.useState(!1),[ge,pe]=i.useState([]),[he,F]=i.useState({}),[G,Le]=i.useState(""),[C,qe]=i.useState(""),[be,Fe]=i.useState(""),[K,ee]=i.useState(""),[H,U]=i.useState(""),b=i.useMemo(()=>S.length>0?S.map(s=>{var r;return{id:s.id,name:s.full_name||n("common.noName"),specialty:((r=s.specialties)==null?void 0:r.join(", "))||""}}):[],[S,n]),w=b.length>0,te=i.useMemo(()=>w?b.map(s=>s.id):["__owner__"],[w,b]),se=i.useMemo(()=>{var s;return w?b.length===1?b[0].id:((s=m[0])==null?void 0:s.staffId)||null:null},[w,b,m]),{hours:He,isClosed:ne}=it((t==null?void 0:t.id)||a,u||void 0),Ue=ct(a),T=He||Ue,re=i.useMemo(()=>{const s=M.reduce((r,y)=>r+(Number(y.duration)||0),0);return s>0?s:30},[M]);i.useEffect(()=>{(async()=>{if(!u){F({});return}if(!w||b.length===0){F({});return}const r=(t==null?void 0:t.id)||a,y=u.getDay(),d=b.map(v=>v.id),{data:k,error:p}=await R.from("staff_schedules").select("staff_id, start_time, end_time, is_available").eq("business_id",r).eq("day_of_week",y).in("staff_id",d);if(p){console.error("Error fetching staff day schedules:",p),F({});return}const N={};for(const v of k||[])v.staff_id&&(N[v.staff_id]={startMin:I(v.start_time),endMin:I(v.end_time),isAvailable:v.is_available!==!1});F(N)})()},[u,w,b,t==null?void 0:t.id,a]);const q=i.useCallback(async()=>{if(!u||!a)return;const s=A(u,"yyyy-MM-dd"),r=(t==null?void 0:t.id)||a,{data:y,error:d}=await R.from("appointments").select("staff_id, start_time, end_time, duration_minutes, status").eq("business_id",r).eq("date",s).in("status",["pending","confirmed","arrived","started"]);if(d){console.error("Error fetching day appointments:",d);return}pe(y||[])},[u,a,t==null?void 0:t.id]);i.useEffect(()=>{if(q(),!u)return;const s=(t==null?void 0:t.id)||a,r=A(u,"yyyy-MM-dd"),y=R.channel(`appointments-${s}`).on("postgres_changes",{event:"*",schema:"public",table:"appointments",filter:`business_id=eq.${s}`},d=>{const k=d.new,p=d.old,N=k==null?void 0:k.date,v=p==null?void 0:p.date;(N===r||v===r)&&q()}).subscribe();return()=>{R.removeChannel(y)}},[q,u,t==null?void 0:t.id,a]),i.useEffect(()=>{if(!w||b.length!==1||M.length===0||m.length>0)return;const s=b[0].id;f(M.map(r=>({serviceId:r.id,serviceName:r.name,staffId:s})))},[w,b,M,m.length]);const ae=i.useMemo(()=>I(T.openTime),[T.openTime]),oe=i.useMemo(()=>I(T.closeTime),[T.closeTime]),ye=i.useMemo(()=>T.lunchStart?I(T.lunchStart):null,[T.lunchStart]),je=i.useMemo(()=>T.lunchEnd?I(T.lunchEnd):null,[T.lunchEnd]),Ne=i.useMemo(()=>{const s=new Map;for(const r of te)s.set(r,[]);for(const r of ge){if(!r.start_time)continue;const y=I(r.start_time),d=r.duration_minutes??(r.end_time?null:30),k=r.end_time&&r.end_time.length>=5?I(r.end_time):y+(d||30),p={startMin:y,endMin:k};if(r.staff_id){const N=r.staff_id,v=s.get(N)||[];v.push(p),s.set(N,v)}else for(const N of te){const v=s.get(N)||[];v.push(p),s.set(N,v)}}for(const[r,y]of s.entries())s.set(r,$e(y));return s},[ge,te]),Q=i.useMemo(()=>{if(!u)return!1;const s=new Date;return u.getDate()===s.getDate()&&u.getMonth()===s.getMonth()&&u.getFullYear()===s.getFullYear()},[u]),ve=i.useMemo(()=>{if(!Q)return 0;const s=new Date;return s.getHours()*60+s.getMinutes()+15},[Q]),Me=i.useMemo(()=>{if(!u)return[];if(c)return[];if(ne)return[];const s=re,r=d=>{const k=Ne.get(d)||[],p=he[d];if(p&&p.isAvailable===!1)return[];const N=p?Math.max(ae,p.startMin):ae,v=p?Math.min(oe,p.endMin):oe;return gt({openMin:N,closeMin:v,durationMin:s,breakStartMin:ye,breakEndMin:je,busy:k,stepByDuration:!0,minStartMin:Q?ve:0})};if(!w)return r("__owner__");if(b.length===1)return r(b[0].id);if(se)return r(se);const y=new Set;for(const d of b)for(const k of r(d.id))y.add(k);return[...y].sort((d,k)=>d-k)},[u,c,ne,re,Ne,ae,oe,ye,je,w,b,se,he,Q,ve]),X=i.useMemo(()=>Me.map(s=>{const r=xt(s);return{id:r,time:r,available:!0}}),[Me]);i.useEffect(()=>{if(!P)return;X.some(r=>r.id===P&&r.available)||W(null)},[P,X]);const ke=M.reduce((s,r)=>s+r.price,0),ze=M.reduce((s,r)=>s+r.duration,0),Oe=b.length===0||(M.length>1?m.every(s=>s.staffId!==null):m.length>0&&((we=m[0])==null?void 0:we.staffId)!==null),z=s=>s.replace(/\D/g,"").length,Se=s=>{const r=z(s);return r>=9&&r<=14},Re=()=>{let s=!0;return G.trim()?ee(""):(ee(n("booking.nameRequired")||"El nombre es obligatorio"),s=!1),C.trim()?Se(C)?U(""):(z(C)<9?U(n("booking.phoneMinDigits")||"El teléfono debe tener mínimo 9 dígitos"):U(n("booking.phoneMaxDigits")||"El teléfono debe tener máximo 14 dígitos"),s=!1):(U(n("booking.phoneRequired")||"El teléfono es obligatorio"),s=!1),s},_e=!c&&u&&P&&Oe&&G.trim()&&C.trim()&&Se(C),Ve=s=>{f(s)},Ye=lt(async()=>{var r,y;if(c){$({title:n("booking.temporarilyClosedTitle"),description:n("booking.temporarilyClosedMessage"),variant:"destructive"});return}if(!Re()){$({title:n("common.error"),description:n("booking.validationError")||"Por favor completa todos los campos requeridos correctamente",variant:"destructive"});return}if(!_e||!u||!P||E)return;D(!0);const s=X.find(d=>d.id===P);if(!s){D(!1),$({title:n("common.error"),description:"Selecciona un horario válido.",variant:"destructive"});return}try{const d=A(u,"yyyy-MM-dd"),k=(t==null?void 0:t.id)||a,{data:p}=await R.from("appointments").select("staff_id, start_time, end_time, duration_minutes, status").eq("business_id",k).eq("date",d).in("status",["pending","confirmed","arrived","started"]),N=I(s.time),v=N+re,O=_=>{if(!(_!=null&&_.start_time))return!1;const Ce=I(_.start_time),Je=_.end_time?I(_.end_time):Ce+(_.duration_minutes||30);return fe(N,v,Ce,Je)},Ee=w?b.length===1?b[0].id:((r=m[0])==null?void 0:r.staffId)||null:null;if((p||[]).some(_=>!w||b.length===1||!Ee||_.staff_id==null||_.staff_id===Ee?O(_):!1)){D(!1),$({title:n("common.error"),description:"Ese horario ya fue reservado. Selecciona otro.",variant:"destructive"}),await q();return}}catch(d){console.error("Pre-insert availability check failed:",d)}try{const d=(t==null?void 0:t.id)||a||"",k=((y=m[0])==null?void 0:y.staffId)||void 0,{error:p}=await L({establishment_id:d,staff_id:k,client_name:G,client_email:be||void 0,client_phone:C||void 0,date:A(u,"yyyy-MM-dd"),start_time:(s==null?void 0:s.time)||"09:00",price:ke,duration_minutes:ze,services:M.map(N=>({id:N.id,name:N.name,price:N.price,duration_minutes:N.duration}))});if(p){console.error("Error saving appointment:",p),$({title:n("common.error"),description:p.includes("exclusion")||p.includes("overlap")?"Ese horario ya fue reservado. Selecciona otro.":"No se pudo crear la reserva. Intenta de nuevo.",variant:"destructive"}),await q();return}$({title:n("booking.bookingConfirmed"),description:`${n("booking.bookingConfirmedDesc")} ${h} - ${A(u,"PPP",{locale:Be})} ${s==null?void 0:s.time}`}),await q(),setTimeout(()=>{o("/appointments")},100)}catch(d){console.error("Error:",d),$({title:n("common.error"),description:"No se pudo crear la reserva. Intenta de nuevo.",variant:"destructive"})}finally{D(!1)}},1e3);return i.useEffect(()=>()=>{pe([]),F({}),f([])},[]),B?e.jsxs("div",{className:"min-h-screen bg-background pb-32",children:[e.jsx("header",{className:"sticky top-0 z-40 bg-card border-b border-border",children:e.jsxs("div",{className:"flex items-center gap-4 h-14 px-4 max-w-lg mx-auto",children:[e.jsx(V,{variant:"ghost",size:"icon",onClick:()=>o(-1),children:e.jsx(Te,{className:"w-5 h-5"})}),e.jsx(Z,{className:"h-5 w-32"})]})}),e.jsxs("main",{className:"max-w-lg mx-auto px-4 py-6 space-y-4",children:[e.jsx(Z,{className:"h-32 rounded-xl"}),e.jsx(Z,{className:"h-48 rounded-xl"}),e.jsx(Z,{className:"h-64 rounded-xl"})]})]}):g||!t?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center px-4",children:[e.jsx("h2",{className:"text-xl font-bold text-foreground mb-2",children:n("common.error")}),e.jsx("p",{className:"text-muted-foreground mb-4",children:n("business.notFound")}),e.jsx(V,{variant:"coral",onClick:()=>o("/"),children:n("common.goBack")})]})}):M.length===0?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center px-4",children:[e.jsx("h2",{className:"text-xl font-bold text-foreground mb-2",children:n("booking.noServices")}),e.jsx("p",{className:"text-muted-foreground mb-4",children:n("booking.selectServicesFirst")}),e.jsx(V,{variant:"coral",onClick:()=>o(`/business/${a}`),children:n("common.goBack")})]})}):e.jsxs("div",{className:"min-h-screen bg-background pb-32",children:[e.jsx("header",{className:"sticky top-0 z-40 bg-card border-b border-border",children:e.jsxs("div",{className:"flex items-center gap-4 h-14 px-4 max-w-lg mx-auto",children:[e.jsx(et,{to:`/business/${a}`,children:e.jsx(V,{variant:"ghost",size:"icon",children:e.jsx(Te,{className:"w-5 h-5"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"font-semibold text-foreground",children:n("booking.title")}),e.jsx("p",{className:"text-xs text-muted-foreground",children:h})]})]})}),e.jsxs("main",{className:"max-w-lg mx-auto px-4 py-6 space-y-8",children:[e.jsxs("section",{className:"animate-fade-in",children:[e.jsx("h2",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wide mb-3",children:n("booking.selectedServices")}),e.jsxs("div",{className:"bg-card rounded-xl border border-border p-4 space-y-2",children:[M.map(s=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ue,{className:"w-4 h-4 text-success"}),e.jsx("span",{className:"text-foreground",children:s.name})]}),e.jsxs("span",{className:"text-muted-foreground text-sm",children:[s.duration," ",n("booking.min")]})]},s.id)),e.jsxs("div",{className:"border-t border-border pt-2 mt-2 flex justify-between",children:[e.jsx("span",{className:"font-medium text-foreground",children:n("booking.total")}),e.jsxs("span",{className:"font-bold text-foreground",children:["RD$ ",ke.toLocaleString()]})]})]})]}),e.jsxs("section",{className:"animate-fade-in",style:{animationDelay:"0.05s"},children:[e.jsx("h2",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wide mb-3",children:n("booking.yourData")}),e.jsxs("div",{className:"bg-card rounded-xl border border-border p-4 space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(le,{htmlFor:"clientName",children:[n("booking.name")," *"]}),e.jsx(ce,{id:"clientName",placeholder:n("booking.namePlaceholder"),value:G,onChange:s=>{Le(s.target.value),K&&ee("")},className:K?"border-destructive":""}),K&&e.jsx("p",{className:"text-sm text-destructive",children:K})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(le,{htmlFor:"clientPhone",children:[n("booking.phone")," *"]}),e.jsx(ce,{id:"clientPhone",type:"tel",placeholder:"+1 809 555 1234",value:C,onChange:s=>{qe(s.target.value),H&&U("")},className:H?"border-destructive":"",maxLength:20}),H&&e.jsx("p",{className:"text-sm text-destructive",children:H}),!H&&C&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:[z(C)," dígitos ",z(C)<9||z(C)>14?"(requiere 9-14)":""]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(le,{htmlFor:"clientEmail",children:n("booking.email")}),e.jsx(ce,{id:"clientEmail",type:"email",placeholder:"tu@email.com",value:be,onChange:s=>Fe(s.target.value)})]})]})]}),b.length>0&&e.jsxs("section",{className:"animate-fade-in",style:{animationDelay:"0.1s"},children:[e.jsxs("h2",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wide mb-3 flex items-center gap-2",children:[e.jsx(me,{className:"w-4 h-4"}),M.length>1?n("booking.assignProfessionals"):n("booking.selectProfessional")]}),e.jsx("div",{className:"bg-card rounded-xl border border-border p-4",children:e.jsx(ft,{services:M,staffMembers:b,onAssignmentsChange:Ve})})]}),e.jsxs("section",{className:"animate-fade-in",style:{animationDelay:"0.15s"},children:[e.jsxs("h2",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wide mb-3 flex items-center gap-2",children:[e.jsx(dt,{className:"w-4 h-4"}),n("booking.selectDate")]}),e.jsx("div",{className:"bg-card rounded-xl border border-border p-4",children:e.jsx(mt,{selected:u,onSelect:J})})]}),u&&e.jsxs("section",{className:"animate-fade-in",children:[e.jsxs("h2",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wide mb-3 flex items-center gap-2",children:[e.jsx(ie,{className:"w-4 h-4"}),n("booking.availableTimes")]}),e.jsx("div",{className:"bg-card rounded-xl border border-border p-4",children:c?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ie,{className:"w-12 h-12 text-destructive mx-auto mb-3"}),e.jsx("p",{className:"text-lg font-medium text-foreground",children:n("booking.temporarilyClosedTitle")}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:n("booking.temporarilyClosedMessage")}),x&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:[n("booking.temporarilyClosedReopens")," ",x]})]}):ne?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ie,{className:"w-12 h-12 text-muted-foreground mx-auto mb-3"}),e.jsx("p",{className:"text-lg font-medium text-foreground",children:n("booking.closedTitle")}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:n("booking.closedMessage")})]}):e.jsx(ut,{slots:X,selected:P,onSelect:W})})]}),e.jsxs("section",{className:"animate-fade-in bg-info/10 rounded-xl p-4",children:[e.jsx("p",{className:"text-sm text-info font-medium",children:n("booking.paymentInfo")}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:n("booking.paymentNote")})]})]}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-card border-t border-border p-4 shadow-elevated z-50",style:{paddingBottom:"calc(1rem + env(safe-area-inset-bottom))"},children:e.jsx("div",{className:"max-w-lg mx-auto",children:e.jsx(V,{variant:"coral",size:"xl",className:"w-full",disabled:!_e||E,onClick:Ye,children:n(E?"booking.confirming":"booking.confirmBooking")})})})]})};export{Bt as default};
