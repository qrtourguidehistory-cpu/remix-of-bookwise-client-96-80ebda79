import{v as q,u as B,b as _,a as H,M as J,r as n,j as e,B as U,O as k,c as f,Q as c}from"./index-Dp23U08K.js";import{S as C}from"./switch-DVJy3Iiq.js";import{C as P}from"./calendar-BgWJMPsN.js";import{T as F}from"./tag-D9pmKqcA.js";import{S as Q}from"./star-CbU948JY.js";import{B as p}from"./bell-CSomtHvE.js";import{A as D}from"./arrow-left-BN-C9m26.js";import{C as V}from"./chevron-up-Bi2pkwYC.js";import{C as G}from"./chevron-down-BHpLwcMw.js";import{T as Z}from"./trash-2-Gv4bX1eT.js";import"./index-ncWG422f.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=q("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),he=()=>{const d=B(),{t:s}=_(),{user:g,profile:o,updateProfile:K}=H(),{notifications:y,loading:T,markAsRead:E,deleteNotification:M}=J(),[I,b]=n.useState(!1),[m,R]=n.useState(!0),[l,N]=n.useState(null),[x,j]=n.useState(0),w=n.useRef(0),v=n.useRef(0),X=t=>{t.read||E(t.id),d(`/notifications/${t.id}`)},$=(t,a)=>{w.current=t.touches[0].clientX,v.current=t.touches[0].clientY,N(a)},z=t=>{if(!l)return;const a=t.touches[0].clientX,i=t.touches[0].clientY,r=a-w.current;Math.abs(i-v.current)<50&&r>0&&j(Math.min(r,80))},A=t=>{x>50&&(M(t),c({title:"Notificación eliminada",description:"La notificación ha sido eliminada"})),N(null),j(0)},[h,S]=n.useState([{id:"appointments",icon:e.jsx(P,{className:"w-5 h-5 text-gray-700",strokeWidth:2}),titleKey:"appointmentReminders",descriptionKey:"appointmentRemindersDesc",enabled:!0},{id:"promotions",icon:e.jsx(F,{className:"w-5 h-5 text-gray-700",strokeWidth:2}),titleKey:"promotions",descriptionKey:"promotionsDesc",enabled:!0},{id:"reviews",icon:e.jsx(Q,{className:"w-5 h-5 text-gray-700",strokeWidth:2}),titleKey:"reviewRequests",descriptionKey:"reviewRequestsDesc",enabled:!1},{id:"messages",icon:e.jsx(ee,{className:"w-5 h-5 text-gray-700",strokeWidth:2}),titleKey:"businessMessages",descriptionKey:"businessMessagesDesc",enabled:!0},{id:"updates",icon:e.jsx(p,{className:"w-5 h-5 text-gray-700",strokeWidth:2}),titleKey:"appUpdates",descriptionKey:"appUpdatesDesc",enabled:!1}]),[L,u]=n.useState(!0);n.useEffect(()=>{(o==null?void 0:o.accepts_marketing)!==null&&(o==null?void 0:o.accepts_marketing)!==void 0&&u(o.accepts_marketing);const t=localStorage.getItem("notificationSettings");if(t){const a=JSON.parse(t);S(i=>i.map(r=>({...r,enabled:a[r.id]??r.enabled})))}},[o]);const O=t=>{const a={};t.forEach(i=>{a[i.id]=i.enabled}),localStorage.setItem("notificationSettings",JSON.stringify(a))},Y=t=>{const a=h.map(r=>r.id===t?{...r,enabled:!r.enabled}:r);S(a),O(a);const i=h.find(r=>r.id===t);c({title:i!=null&&i.enabled?s("notifications.deactivated"):s("notifications.activated"),description:`${s(`notifications.${i==null?void 0:i.titleKey}`)}`})},W=async t=>{if(!g){u(t),localStorage.setItem("emailNotifications",JSON.stringify(t)),c({title:s(t?"notifications.weeklySummaryActivated":"notifications.weeklySummaryDeactivated")});return}b(!0);try{const{error:a}=await K({accepts_marketing:t});if(a)throw a;u(t),c({title:s(t?"notifications.weeklySummaryActivated":"notifications.weeklySummaryDeactivated")})}catch(a){console.error("Error saving email preference:",a),c({title:s("common.error"),description:"No se pudo guardar la preferencia",variant:"destructive"})}finally{b(!1)}};return g?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("header",{className:"bg-card border-b border-border sticky top-0 z-10",children:e.jsxs("div",{className:"px-4 py-4 max-w-lg mx-auto flex items-center gap-3",children:[e.jsx("button",{onClick:()=>d(-1),className:"p-2 -ml-2 hover:bg-secondary rounded-lg transition-colors",children:e.jsx(D,{className:"w-5 h-5 text-foreground"})}),e.jsx("h1",{className:"text-lg font-semibold text-foreground",children:s("notifications.title")})]})}),e.jsxs("main",{className:"max-w-lg mx-auto px-4 py-6 space-y-6",children:[e.jsxs("section",{className:"animate-fade-in",children:[e.jsxs("button",{onClick:()=>R(!m),className:"w-full flex items-center justify-between mb-3 group",children:[e.jsx("h2",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wide",children:s("notifications.history")||"Historial"}),m?e.jsx(V,{className:"w-4 h-4 text-muted-foreground group-hover:text-foreground transition-colors"}):e.jsx(G,{className:"w-4 h-4 text-muted-foreground group-hover:text-foreground transition-colors"})]}),m&&e.jsx(e.Fragment,{children:T?e.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200/50 shadow-sm p-8 text-center",children:[e.jsx(k,{className:"w-6 h-6 animate-spin text-gray-500 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-500",children:s("common.loading")||"Cargando..."})]}):y.length===0?e.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200/50 shadow-sm p-8 text-center",children:[e.jsx(p,{className:"w-12 h-12 text-gray-400 mx-auto mb-3 opacity-50"}),e.jsx("p",{className:"text-gray-500",children:s("notifications.noNotifications")||"No hay notificaciones"})]}):e.jsx("div",{className:"bg-white rounded-2xl border border-gray-200/50 shadow-sm overflow-hidden",children:y.map((t,a)=>e.jsxs("div",{className:"relative border-b border-gray-100 last:border-0 overflow-hidden",onTouchStart:i=>$(i,t.id),onTouchMove:z,onTouchEnd:()=>A(t.id),style:{transform:l===t.id?`translateX(${x}px)`:"translateX(0)",transition:l===t.id?"none":"transform 0.3s ease-out"},children:[e.jsx("div",{className:f("absolute left-0 top-0 bottom-0 w-20 bg-red-500 flex items-center justify-center z-10",l===t.id&&x>0?"opacity-100":"opacity-0"),style:{transition:"opacity 0.2s ease-out"},children:e.jsx(Z,{className:"w-5 h-5 text-white"})}),e.jsxs("button",{onClick:()=>X(t),className:f("w-full flex items-start gap-3 p-4 text-left transition-colors hover:bg-gray-50/50 relative z-20 bg-white",!t.read&&"bg-primary/5"),children:[e.jsx("div",{className:"flex-shrink-0 pt-1",children:e.jsx("div",{className:f("w-1.5 h-1.5 rounded-full",t.read?"bg-gray-300":"bg-primary")})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"flex items-center gap-2 mb-1",children:e.jsx("p",{className:"font-semibold text-gray-900 text-[15px]",children:t.title})}),e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2 mb-1 leading-relaxed",children:t.message}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:t.time})]})]})]},t.id))})})]}),e.jsxs("section",{className:"animate-fade-in",style:{animationDelay:"0.1s"},children:[e.jsx("h2",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wide mb-3",children:s("notifications.push")}),e.jsx("div",{className:"bg-card rounded-2xl border border-border overflow-hidden",children:h.map((t,a)=>e.jsxs("div",{className:"flex items-center justify-between px-4 py-4 border-b border-border last:border-0 animate-fade-in",style:{animationDelay:`${a*.05}s`},children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1 pr-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gray-100 flex items-center justify-center flex-shrink-0",children:t.icon}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:s(`notifications.${t.titleKey}`)}),e.jsx("p",{className:"text-sm text-muted-foreground mt-0.5",children:s(`notifications.${t.descriptionKey}`)})]})]}),e.jsx(C,{checked:t.enabled,onCheckedChange:()=>Y(t.id)})]},t.id))})]}),e.jsxs("section",{className:"animate-fade-in",style:{animationDelay:"0.2s"},children:[e.jsx("h2",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wide mb-3",children:s("notifications.emailSection")}),e.jsx("div",{className:"bg-card rounded-2xl border border-border overflow-hidden",children:e.jsxs("div",{className:"flex items-center justify-between px-4 py-4",children:[e.jsxs("div",{className:"flex-1 pr-4",children:[e.jsx("p",{className:"font-medium text-foreground",children:s("notifications.weeklySummary")}),e.jsx("p",{className:"text-sm text-muted-foreground mt-0.5",children:s("notifications.weeklySummaryDesc")})]}),I?e.jsx(k,{className:"w-5 h-5 animate-spin text-muted-foreground"}):e.jsx(C,{checked:L,onCheckedChange:W})]})})]}),e.jsx("p",{className:"text-xs text-muted-foreground text-center animate-fade-in",style:{animationDelay:"0.3s"},children:s("notifications.preferencesNote")})]})]}):e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("header",{className:"bg-card border-b border-border sticky top-0 z-10",children:e.jsxs("div",{className:"px-4 py-4 max-w-lg mx-auto flex items-center gap-3",children:[e.jsx("button",{onClick:()=>d(-1),className:"p-2 -ml-2 hover:bg-secondary rounded-lg transition-colors",children:e.jsx(D,{className:"w-5 h-5 text-foreground"})}),e.jsx("h1",{className:"text-lg font-semibold text-foreground",children:s("notifications.title")})]})}),e.jsx("main",{className:"max-w-lg mx-auto px-4 py-6",children:e.jsxs("div",{className:"text-center py-16",children:[e.jsx(p,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Inicia sesión para gestionar tus notificaciones"}),e.jsx(U,{variant:"coral",onClick:()=>d("/auth"),children:s("common.login")})]})})]})};export{he as default};
